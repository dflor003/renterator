(function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("knockout"),exports):typeof define=="function"&&define.amd?define(["knockout","exports"],n):n(ko,ko.validation={})})(function(n,t){function l(n,i,r){return i.validator(n(),r.params===undefined?!0:r.params)?!0:(n.error(t.formatMessage(r.message||i.message,r.params)),n.__valid__(!1),!1)}function a(n,i,r){n.isValidating(!0);var u=function(u){var f=!1,e="";if(!n.__valid__()){n.isValidating(!1);return}u.message?(f=u.isValid,e=u.message):f=u,f||(n.error(t.formatMessage(e||r.message||i.message,r.params)),n.__valid__(f)),n.isValidating(!1)};i.validator(n(),r.params||!0,u)}var r,s;if(typeof n===undefined)throw"Knockout is required, please ensure it is loaded before loading this validation plug-in";r=t,n.validation=r;var e={registerExtenders:!0,messagesOnModified:!0,errorsAsTitle:!0,errorsAsTitleOnModified:!1,messageTemplate:null,insertMessages:!0,parseInputAttributes:!1,writeInputAttributes:!1,decorateElement:!1,errorClass:null,errorElementClass:"validationElement",errorMessageClass:"validationMessage",grouping:{deep:!1,observable:!0}},u=n.utils.extend({},e),o=["required","pattern","min","max","step"],h=["email","number","date"],c=function(n){window.setImmediate?window.setImmediate(n):window.setTimeout(n,0)},i=function(){var r=(new Date).getTime(),t={},n="__ko_validation__";return{isArray:function(n){return n.isArray||Object.prototype.toString.call(n)==="[object Array]"},isObject:function(n){return n!==null&&typeof n=="object"},values:function(n){var i=[],t;for(t in n)n.hasOwnProperty(t)&&i.push(n[t]);return i},getValue:function(n){return typeof n=="function"?n():n},hasAttribute:function(n,t){return n.getAttribute(t)!==null},getAttribute:function(n,t){return n.getAttribute(t)},setAttribute:function(n,t,i){return n.setAttribute(t,i)},isValidatable:function(n){return n&&n.rules&&n.isValid&&n.isModified},insertAfter:function(n,t){n.parentNode.insertBefore(t,n.nextSibling)},newId:function(){return r+=1},getConfigOptions:function(n){var t=i.contextFor(n);return t||u},setDomData:function(r,u){var f=r[n];f||(r[n]=f=i.newId()),t[f]=u},getDomData:function(i){var r=i[n];return r?t[r]:undefined},contextFor:function(n){switch(n.nodeType){case 1:case 8:var t=i.getDomData(n);if(t)return t;if(n.parentNode)return i.contextFor(n.parentNode)}return undefined},isEmptyVal:function(n){return n===undefined?!0:n===null?!0:n===""?!0:void 0},getOriginalElementTitle:function(n){var t=i.getAttribute(n,"data-orig-title"),r=n.title,u=i.hasAttribute(n,"data-orig-title");return u?t:r}}}(),f=function(){var r=0;return{utils:i,init:function(i,f){r>0&&!f||(i=i||{},i.errorElementClass=i.errorElementClass||i.errorClass||u.errorElementClass,i.errorMessageClass=i.errorMessageClass||i.errorClass||u.errorMessageClass,n.utils.extend(u,i),u.registerExtenders&&t.registerExtenders(),r=1)},configure:function(n){t.init(n)},reset:function(){u=jQuery.extend(u,e)},group:function(t,r){r=n.utils.extend(n.utils.extend({},u.grouping),r);var e=n.observableArray([]),f=null,o=function o(t,u){var s=[],f=n.utils.unwrapObservable(t);u=u!==undefined?u:r.deep?1:-1,n.isObservable(t)&&(t.isValid||t.extend({validatable:!0}),e.push(t)),f&&(i.isArray(f)?s=f:i.isObject(f)&&(s=i.values(f))),u!==0&&n.utils.arrayForEach(s,function(n){n&&!n.nodeType&&o(n,u+1)})};return r.observable?(o(t),f=n.computed(function(){var t=[];return n.utils.arrayForEach(e(),function(n){n.isValid()||t.push(n.error)}),t})):f=function(){var i=[];return e([]),o(t),n.utils.arrayForEach(e(),function(n){n.isValid()||i.push(n.error)}),i},f.showAllMessages=function(t){t===undefined&&(t=!0),f(),n.utils.arrayForEach(e(),function(n){n.isModified(t)})},t.errors=f,t.isValid=function(){return t.errors().length===0},t.isAnyMessageShown=function(){var t=!1;return f(),n.utils.arrayForEach(e(),function(n){!n.isValid()&&n.isModified()&&(t=!0)}),t},f},formatMessage:function(t,i){return typeof t=="function"?t(i):t.replace(/\{0\}/gi,n.utils.unwrapObservable(i))},addRule:function(n,t){return n.extend({validatable:!0}),n.rules.push(t),n},addAnonymousRule:function(n,r){var u=i.newId();r.message===undefined&&(r.message="Error"),t.rules[u]=r,t.addRule(n,{rule:u,params:r.params})},addExtender:function(r){n.extenders[r]=function(n,u){return u.message||u.onlyIf?t.addRule(n,{rule:r,message:u.message,params:i.isEmptyVal(u.params)?!0:u.params,condition:u.onlyIf}):t.addRule(n,{rule:r,params:u})}},registerExtenders:function(){if(u.registerExtenders)for(var i in t.rules)t.rules.hasOwnProperty(i)&&(n.extenders[i]||t.addExtender(i))},insertValidationMessage:function(n){var t=document.createElement("SPAN");return t.className=i.getConfigOptions(n).errorMessageClass,i.insertAfter(n,t),t},parseInputValidationAttributes:function(r,u){n.utils.arrayForEach(o,function(n){i.hasAttribute(r,n)&&t.addRule(u(),{rule:n,params:r.getAttribute(n)||!0})});var f=r.getAttribute("type");n.utils.arrayForEach(h,function(n){n===f&&t.addRule(u(),{rule:n==="date"?"dateISO":n,params:!0})})},writeInputValidationAttributes:function(t,i){var r=i(),u;r&&r.rules&&(u=r.rules(),n.utils.arrayForEach(o,function(i){var f,r=n.utils.arrayFirst(u,function(n){return n.rule.toLowerCase()===i.toLowerCase()});r&&(f=r.params,r.rule==="pattern"&&r.params instanceof RegExp&&(f=r.params.source),t.setAttribute(i,f))}),u=null)},makeBindingHandlerValidatable:function(t){var i=n.bindingHandlers[t].init;n.bindingHandlers[t].init=function(t,r,u,f,e){return i(t,r,u),n.bindingHandlers.validationCore.init(t,r,u,f,e)}}}}();n.utils.extend(r,f),r.rules={},r.rules.required={validator:function(n,t){var i;return n===undefined||n===null?!t:(i=n,typeof n=="string"&&(i=n.replace(/^\s+|\s+$/g,"")),!t)?!0:(i+"").length>0},message:"This field is required."},r.rules.min={validator:function(n,t){return i.isEmptyVal(n)||n>=t},message:"Please enter a value greater than or equal to {0}."},r.rules.max={validator:function(n,t){return i.isEmptyVal(n)||n<=t},message:"Please enter a value less than or equal to {0}."},r.rules.minLength={validator:function(n,t){return i.isEmptyVal(n)||n.length>=t},message:"Please enter at least {0} characters."},r.rules.maxLength={validator:function(n,t){return i.isEmptyVal(n)||n.length<=t},message:"Please enter no more than {0} characters."},r.rules.pattern={validator:function(n,t){return i.isEmptyVal(n)||n.toString().match(t)!==null},message:"Please check this value."},r.rules.step={validator:function(n,t){return i.isEmptyVal(n)||n*100%(t*100)==0},message:"The value must increment by {0}"},r.rules.email={validator:function(n,t){return t?i.isEmptyVal(n)||t&&/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(n):!0},message:"Please enter a proper email address"},r.rules.date={validator:function(n,t){return t?i.isEmptyVal(n)||t&&!/Invalid|NaN/.test(new Date(n)):!0},message:"Please enter a proper date"},r.rules.dateISO={validator:function(n,t){return t?i.isEmptyVal(n)||t&&/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(n):!0},message:"Please enter a proper date"},r.rules.number={validator:function(n,t){return t?i.isEmptyVal(n)||t&&/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(n):!0},message:"Please enter a number"},r.rules.digit={validator:function(n,t){return t?i.isEmptyVal(n)||t&&/^\d+$/.test(n):!0},message:"Please enter a digit"},r.rules.phoneUS={validator:function(n,t){return t?typeof n!="string"?!1:i.isEmptyVal(n)?!0:(n=n.replace(/\s+/g,""),t&&n.length>9&&n.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)):!0},message:"Please specify a valid phone number"},r.rules.equal={validator:function(n,t){var r=t;return n===i.getValue(r)},message:"Values must equal"},r.rules.notEqual={validator:function(n,t){var r=t;return n!==i.getValue(r)},message:"Please choose another value."},r.rules.unique={validator:function(t,r){var u=i.getValue(r.collection),f=i.getValue(r.externalValue),e=0;return!t||!u?!0:(n.utils.arrayFilter(n.utils.unwrapObservable(u),function(n){t===(r.valueAccessor?r.valueAccessor(n):n)&&e++}),e<(f!==undefined&&t!==f?1:2))},message:"Please make sure the value is unique."},function(){r.registerExtenders()}(),n.bindingHandlers.validationCore=function(){return{init:function(r,u){var f=i.getConfigOptions(r),e;f.parseInputAttributes&&c(function(){t.parseInputValidationAttributes(r,u)}),f.insertMessages&&i.isValidatable(u())&&(e=t.insertValidationMessage(r),f.messageTemplate?n.renderTemplate(f.messageTemplate,{field:u()},null,e,"replaceNode"):n.applyBindingsToNode(e,{validationMessage:u()})),f.writeInputAttributes&&i.isValidatable(u())&&t.writeInputValidationAttributes(r,u),f.decorateElement&&i.isValidatable(u())&&n.applyBindingsToNode(r,{validationElement:u()})},update:function(){}}}(),f.makeBindingHandlerValidatable("value"),f.makeBindingHandlerValidatable("checked"),n.bindingHandlers.validationMessage={update:function(t,r){var u=r(),o=i.getConfigOptions(t),c=n.utils.unwrapObservable(u),f=!1,e=!1,s,h;u.extend({validatable:!0}),f=u.isModified(),e=u.isValid(),s=function(){return!o.messagesOnModified||f?e?null:u.error:null},h=function(){return!o.messagesOnModified||f?!e:!1},n.bindingHandlers.text.update(t,s),n.bindingHandlers.visible.update(t,h)}},n.bindingHandlers.validationElement={update:function(t,r){var u=r(),f=i.getConfigOptions(t),c=n.utils.unwrapObservable(u),e=!1,o=!1,s;if(u.extend({validatable:!0}),e=u.isModified(),o=u.isValid(),s=function(){var n={},t=e?!o:!1;return f.decorateElement||(t=!1),n[f.errorElementClass]=t,n},n.bindingHandlers.css.update(t,s),f.errorsAsTitle){var l=i.getAttribute(t,"data-orig-title"),a=t.title,v=i.getAttribute(t,"data-orig-title")==="true",h=function(){if(!f.errorsAsTitleOnModified||e)return o?{title:i.getOriginalElementTitle(t),"data-orig-title":null}:{title:u.error,"data-orig-title":i.getOriginalElementTitle(t)}};n.bindingHandlers.attr.update(t,h)}}},n.bindingHandlers.validationOptions=function(){return{init:function(t,r){var e=n.utils.unwrapObservable(r()),f;e&&(f=n.utils.extend({},u),n.utils.extend(f,e),i.setDomData(t,f))}}}(),n.extenders.validation=function(r,u){return n.utils.arrayForEach(i.isArray(u)?u:[u],function(n){t.addAnonymousRule(r,n)}),r},n.extenders.validatable=function(r,u){var f,e;return u&&!i.isValidatable(r)?(r.error=n.observable(null),r.rules=n.observableArray(),r.isValidating=n.observable(!1),r.__valid__=n.observable(!0),r.isModified=n.observable(!1),f=n.computed(function(){var n=r(),i=r.rules();return t.validateObservable(r),!0}),r.isValid=n.computed(function(){return r.__valid__()}),e=r.subscribe(function(){r.isModified(!0)}),r._disposeValidation=function(){r.isValid.dispose(),r.rules.removeAll(),r.isModified._subscriptions.change=[],r.isValidating._subscriptions.change=[],r.__valid__._subscriptions.change=[],e.dispose(),f.dispose(),delete r.rules,delete r.error,delete r.isValid,delete r.isValidating,delete r.__valid__,delete r.isModified}):u===!1&&i.isValidatable(r)&&r._disposeValidation&&r._disposeValidation(),r},r.validateObservable=function(n){for(var u=0,r,i,f=n.rules(),e=f.length;u<e;u++)if(i=f[u],!i.condition||i.condition())if(r=t.rules[i.rule],r.async||i.async)a(n,r,i);else if(!l(n,r,i))return!1;return n.error(null),n.__valid__(!0),!0},n.validatedObservable=function(i){if(!t.utils.isObject(i))return n.observable(i).extend({validatable:!0});var r=n.observable(i);return r.errors=t.group(i),r.isValid=n.computed(function(){return r.errors().length===0}),r},r.localize=function(n){var i;for(i in n)t.rules.hasOwnProperty(i)&&(t.rules[i].message=n[i])},n.applyBindingsWithValidation=function(i,r,u){var o=arguments.length,f,e;o>2?(f=r,e=u):o<2?f=document.body:arguments[1].nodeType?f=r:e=arguments[1],t.init(),e&&t.utils.setDomData(f,e),n.applyBindings(i,r)},s=n.applyBindings,n.applyBindings=function(n,i){t.init(),s(n,i)}});
//@ sourceMappingURL=knockout.validation.min.js.map